<?php
 goto Oh0Sf; Oh0Sf: defined("\111\x4e\137\x49\101") or exit("\x41\x63\143\x65\163\163\x20\104\x65\156\151\145\144"); goto WcuT1; WcuT1: require_once "\x6c\151\x62\x2f\x63\157\155\155\x6f\156\56\x70\x68\x70"; goto CULGI; CULGI: class baiban_wxlinksModuleReceiver extends WeModuleReceiver { public function receive() { goto hVR_M; frcpP: $custom = $this->miniapp(); goto KdJWt; IK0Hc: if (!empty($user)) { goto cfCqq; } goto MR35h; hVR_M: global $_W; goto It0eh; plJZF: $custom = array("\155\163\x67\164\171\x70\145" => "\154\151\156\153", "\154\x69\x6e\153" => array("\x74\x69\164\154\x65" => urlencode("\342\221\xa1\xe7\x82\xb9\345\x87\xbb\xe8\277\x99\351\207\214\351\200\x89\346\x8b\251\xe8\xa6\201\xe7\xbb\x91\345\xae\x9a\xe6\216\210\xe6\235\x83\xe7\x9a\x84\345\xb0\x8f\xe7\250\x8b\xe5\xba\217"), "\144\145\163\143\x72\x69\x70\x74\x69\157\x6e" => urlencode("\xe8\257\xb7\346\263\xa8\346\204\217\xef\274\x8c\xe6\202\250\xe6\xad\243\xe4\xbd\xbf\347\224\250\347\x9a\x84\345\xbe\xae\344\xbf\241\345\217\267\345\277\205\xe9\241\xbb\xe4\270\xba\350\246\x81\xe6\x8e\210\346\235\203\347\x9a\x84\345\xb0\x8f\347\xa8\213\345\xba\217\xe7\x9a\204\xe7\256\241\347\220\206\345\x91\230\357\xbc\x81\357\xbc\201"), "\x75\162\154" => murl("\x65\156\x74\162\x79\x2f\x77\170\141\x70\x70\57\x61\x75\164\150", array("\x6d" => "\x62\141\151\x62\141\156\137\167\170\x6c\x69\156\x6b\163", "\x6f\x70\145\x6e\151\x64" => $user["\x6f\160\145\156\151\144"]), true, true), "\160\x69\143\165\162\154" => ''), "\x74\157\165\x73\145\x72" => $this->message["\146\162\x6f\x6d"]); goto xcM3Y; m0n7i: $user = pdo_get("\x62\141\x69\x62\x61\156\137\167\170\154\151\x6e\153\x73\137\165\163\x65\x72\163", array("\157\160\x65\156\151\144" => $this->message["\146\x72\x6f\155"], "\143\150\141\x6e\x6e\145\x6c" => "\345\276\256\344\xbf\241\xe5\xb0\x8f\347\xa8\x8b\xe5\xba\x8f")); goto Jmzqy; E2n90: if (!($type == "\155\151\x6e\x69\160\162\157\147\x72\x61\155\160\141\x67\x65")) { goto y5rsX; } goto m0n7i; m5ubI: cfCqq: goto plJZF; N1Fda: exit; goto m5ubI; MR35h: $custom = array("\155\163\x67\164\x79\x70\145" => "\164\145\170\164", "\164\x65\170\x74" => array("\x63\157\156\164\x65\156\164" => urlencode("\xe8\xaf\xb7\345\205\x88\347\x99\xbb\xe5\xbd\225\xe5\xb0\217\347\250\x8b\345\xba\217")), "\x74\x6f\165\x73\145\x72" => $this->message["\146\162\x6f\155"]); goto lI6Ol; Jmzqy: if ($this->message["\x70\141\147\x65\160\x61\x74\x68"] == "\160\141\x67\145\163\x2f\x69\x6e\144\145\x78\57\142\x69\156\x64\167\170\x61\x70\x70") { goto FZDR2; } goto frcpP; xcM3Y: sendWxappCustomNotice($custom); goto Ce63A; Ce63A: exit; goto iFMfi; It0eh: $type = $this->message["\164\x79\160\x65"]; goto E2n90; lI6Ol: sendWxappCustomNotice($custom); goto N1Fda; XtcQ5: y5rsX: goto r_GDd; iFMfi: HIc5g: goto XtcQ5; n1gP4: FZDR2: goto IK0Hc; KdJWt: goto HIc5g; goto n1gP4; r_GDd: } private function miniapp() { goto IZ70_; znvel: if (!isset($fullpath[1])) { goto hBOu7; } goto ZswLq; M3AOQ: if (isset($query["\154\x69\x6e\x6b\151\144"])) { goto wYndD; } goto tC1uL; cO0j2: sendWxappCustomNotice(array("\x6d\163\x67\164\x79\x70\145" => "\x69\x6d\x61\x67\x65", "\x69\155\x61\x67\x65" => array("\x6d\x65\x64\151\x61\137\x69\144" => $result["\x6d\145\144\x69\141\137\x69\x64"]), "\164\157\x75\x73\145\162" => $this->message["\x66\162\x6f\x6d"])); goto vGOFT; bVB1a: if ($link) { goto QFfv4; } goto WKltP; xr9a6: xo1Ad: goto kQzAO; YcwbL: return $this->retText("\346\204\x9f\xe8\xb0\242\346\x82\250\347\232\204\xe4\275\277\347\224\250"); goto zfugo; EnqZ7: hBOu7: goto CgFNl; pD5G7: FPJ_V: goto M3AOQ; IZ70_: $fullpath = explode("\77", $this->message["\160\141\x67\x65\160\141\x74\150"]); goto bnkCj; ghNzo: $link = pdo_get("\142\141\151\x62\x61\156\x5f\167\170\x6c\151\156\x6b\163\x5f\154\151\156\153\x73", array("\151\144" => $query["\154\x69\x6e\x6b\151\144"])); goto bVB1a; wfEZ9: sendWxappCustomNotice(array("\x6d\x73\147\x74\171\x70\145" => "\x74\x65\170\164", "\x74\145\x78\164" => array("\x63\x6f\x6e\164\145\156\x74" => urlencode("\347\x82\xb9\xe5\x87\273\344\270\213\xe6\x96\271\xe4\272\x8c\347\273\264\xe7\xa0\x81\357\xbc\214\351\x95\xbf\346\214\x89\xe8\257\x86\345\210\253\346\267\xbb\xe5\x8a\xa0" . $link["\x74\x79\x70\x65"])), "\x74\x6f\165\163\145\x72" => $this->message["\x66\x72\x6f\155"])); goto cO0j2; jXqzn: QFfv4: goto DOlZX; vGOFT: exit; goto M5u5d; TJjpA: goto FE_ii; goto Bl111; zfugo: goto lBKN7; goto pD5G7; DOlZX: FE_ii: goto tVTlu; tC1uL: return $this->retText("\346\234\252\350\x83\xbd\xe8\x8e\267\345\217\x96\xe9\223\276\xe6\x8e\245\111\104"); goto TJjpA; cDjjc: return $this->retText($result["\155\x65\x73\x73\x61\x67\145"]); goto j_V0K; CgFNl: if ($path == "\x70\x61\147\145\x73\x2f\x69\x6e\144\145\170\57\x75\x6e\151\154\151\156\153") { goto FPJ_V; } goto YcwbL; tVTlu: if (file_exists(ATTACHMENT_ROOT . $link["\x72\x65\164\165\162\156"])) { goto xo1Ad; } goto EQb6Y; j_V0K: TOOwX: goto wfEZ9; Bl111: wYndD: goto ghNzo; bLO4w: $query = array(); goto znvel; XQXkP: if (!is_error($result)) { goto TOOwX; } goto cDjjc; EQb6Y: return $this->retText("\xe8\277\224\xe5\x9b\x9e\xe6\225\260\xe6\215\256\xe4\xb8\242\xe5\xa4\xb1"); goto xr9a6; M5u5d: lBKN7: goto tx59h; kQzAO: $result = $this->uploadMedia(ATTACHMENT_ROOT . $link["\x72\x65\x74\x75\x72\156"], "\x69\155\141\x67\x65\163"); goto XQXkP; bnkCj: $path = $fullpath[0]; goto bLO4w; WKltP: return $this->retText("\xe9\x93\276\xe6\216\245\345\xb7\262\xe5\x88\xa0\351\x99\xa4"); goto jXqzn; ZswLq: parse_str($fullpath[1], $query); goto EnqZ7; tx59h: } private function retText($content) { sendWxappCustomNotice(array("\x6d\163\x67\164\171\160\145" => "\x74\145\x78\164", "\164\x65\x78\x74" => array("\x63\x6f\156\x74\x65\156\x74" => urlencode($content)), "\164\x6f\x75\x73\x65\x72" => $this->message["\x66\162\157\x6d"])); exit; } private function uploadMedia($path, $type = "\151\155\141\x67\145") { goto jRWDf; f1t1x: D1OpF: goto UvkSr; T0B72: $account_api = WeAccount::create($_W["\x75\x6e\151\x61\x63\x69\144"]); goto uX9VG; uX9VG: $token = $account_api->getAccessToken(); goto C7Vt1; PRZdw: $response = ihttp_request($url, $data); goto PvJFf; LPzR1: mFZaU: goto GoRy6; ydqfA: return error($result["\145\x72\162\x63\157\x64\x65"], "\xe8\256\xbf\351\x97\256\345\x85\254\xe4\274\227\345\271\xb3\xe5\217\xb0\xe6\x8e\xa5\345\217\243\xe5\244\xb1\350\xb4\xa5\54\40\351\224\x99\350\xaf\xaf\350\xaf\xa6\346\203\205\72\40{$this->errorCode($result["\x65\x72\x72\x63\x6f\x64\x65"])}"); goto LxRTG; lCHJT: goto CBUjb; goto Gr2aJ; Gb2ZC: BsFDl: goto T0B72; GoRy6: return error($result["\145\x72\162\x63\x6f\x64\145"], "\350\256\xbf\351\227\xae\xe5\205\254\xe4\274\x97\345\xb9\xb3\xe5\217\260\xe6\216\xa5\xe5\217\243\345\244\xb1\xe8\xb4\245\x2c\40\xe9\x94\231\350\xaf\xaf\x3a\x20{$result["\145\162\x72\155\x73\147"]}\x2c\xe9\224\x99\350\xaf\257\350\257\246\346\x83\x85\357\xbc\x9a{$this->errorCode($result["\145\162\162\143\157\x64\145"])}"); goto hjhBw; hjhBw: CBUjb: goto xdpiN; z2L_J: return $token; goto EaLD9; u7TPJ: $data = array("\x6d\145\144\x69\x61" => "\100" . $path); goto PRZdw; gUUaE: if (!in_array(substr(ltrim($path, "\57"), 0, 6), array("\151\x6d\x61\x67\145\163", "\166\x69\144\x65\157\x73", "\x61\x75\x64\151\x6f\163", "\164\x68\165\155\142"))) { goto D1OpF; } goto Tpofk; LxRTG: sGFdt: goto RGJHX; Gr2aJ: Lxf0g: goto AkEDa; dQiPr: if (!empty($path)) { goto eRLsw; } goto rfT2G; r1QBO: return error(1, "\xe6\226\207\344\xbb\266\xe4\270\x8d\345\xad\x98\xe5\x9c\xa8"); goto Gb2ZC; IK2GD: goto CBUjb; goto LPzR1; RGJHX: if (empty($result)) { goto Lxf0g; } goto jaP9R; xdpiN: return $result; goto vqLaz; u1ku5: if (!is_error($response)) { goto sGFdt; } goto ydqfA; PvJFf: $result = @json_decode($response["\x63\x6f\x6e\164\x65\156\164"], true); goto u1ku5; EaLD9: jZRO1: goto bb0aX; UvkSr: if (file_exists($path)) { goto BsFDl; } goto r1QBO; Tpofk: $path = ATTACHMENT_ROOT . ltrim($path, "\57"); goto f1t1x; AkEDa: return $response; goto IK2GD; bb0aX: $url = "\x68\x74\164\160\163\x3a\x2f\x2f\x61\160\x69\x2e\167\x65\x69\x78\x69\156\56\x71\161\56\143\x6f\x6d\x2f\143\x67\x69\x2d\142\151\156\57\x6d\145\x64\151\141\57\165\x70\x6c\157\x61\x64\77\141\143\143\145\x73\163\x5f\x74\157\x6b\x65\x6e\75{$token}\x26\x74\171\x70\145\75{$type}"; goto u7TPJ; XiJjm: eRLsw: goto gUUaE; C7Vt1: if (!is_error($token)) { goto jZRO1; } goto z2L_J; jaP9R: if (!empty($result["\x65\162\x72\x63\x6f\x64\145"])) { goto mFZaU; } goto lCHJT; jRWDf: global $_W; goto dQiPr; rfT2G: return error(-1, "\xe5\217\202\xe6\x95\260\xe9\x94\231\350\xaf\xaf"); goto XiJjm; vqLaz: } }